function _typeof(n){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function ownKeys(e,n){var t,i=Object.keys(e);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(e),n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,t)),i}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(t),!0).forEach(function(n){_defineProperty(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function _defineProperty(n,e,t){return(e=_toPropertyKey(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _toPropertyKey(n){n=_toPrimitive(n,"string");return"symbol"==_typeof(n)?n:n+""}function _toPrimitive(n,e){if("object"!=_typeof(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0===t)return("string"===e?String:Number)(n);t=t.call(n,e||"default");if("object"!=_typeof(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}var wffnFunnel={isSetUpCached:function(){var n;return(void 0===window.wffnPublicVars.current_step||"wc_checkout"!==window.wffnPublicVars.current_step.type)&&(n=(new Date).getTime()/1e3,20<parseInt(n-parseInt(window.wffnPublicVars.setup_time)))},setUpFunnel:function(){this.init()},init:function(){var i=this;if(this.isSetUpCached()){console.log("cached setup found");try{var n={events:"undefined"!=typeof wffnEvents?wffnEvents:[]};this.SendData("wffn_maybe_setup_funnel",_objectSpread(_objectSpread({},window.wffnfunnelEnvironment),{},{track_data:n,hash:window.wffnPublicVars.hash}),function(n){var e,t;n&&n.hash&&(Cookies.set("wffn_si",n.hash,{path:"/"}),e=n.hash,t=n.current_step.id,window.wffnPublicVars.hash=e,i.HandleAnalytics(e,t,"onload","",n.track_views)),n&&n.next_link&&(window.wffnPublicVars.next_link=n.next_link)})}catch(n){console.log(n)}}else"undefined"!=typeof Cookies&&(void 0!==Cookies.get("wffn_si")&&void 0!==window.wffnfunnelEnvironment&&Object.hasOwnProperty.call(window.wffnfunnelEnvironment,"post_type")&&-1!==["wffn_ty","wffn_oty"].indexOf(window.wffnfunnelEnvironment.post_type)?this.HandleAnalytics(Cookies.get("wffn_si"),window.wffnfunnelEnvironment.id,"onload",window.wffnfunnelEnvironment):void 0!==window.wffnPublicVars&&Object.hasOwnProperty.call(window.wffnfunnelData,"hash")&&(Cookies.set("wffn_si",window.wffnfunnelData.hash,{path:"/"}),this.HandleAnalytics(window.wffnfunnelData.hash,window.wffnfunnelData.current_step.id))||this.maybeHandleEcommEvents())},analyticsAlready:function(n,e){if(void 0!==Cookies.get("wffn_ay_"+n)&&""!==Cookies.get("wffn_ay_"+n)){n=JSON.parse(Cookies.get("wffn_ay_"+n));if(Array.isArray(n)&&0<=jQuery.inArray(parseInt(e),n))return!0}return!1},maybeHandleEcommEvents:function(){var n,e;"undefined"==typeof wffnEvents||0===wffnEvents.length?this.setupWffnEventsListener():(n=wffnEvents,e="undefined"!=typeof wffnfunnelEnvironment?wffnfunnelEnvironment:null,this.SendData("wffn_tracking_events",{events_data:n,step_data:e},function(){}))},setupWffnEventsListener:function(){var e=this;this.wffnEventsListenerSetup||(this.wffnEventsListenerSetup=!0,document.addEventListener("wffnEventsReady",function(n){"undefined"!=typeof wffnEvents&&0<wffnEvents.length&&!e.wffnEventsProcessed&&(e.wffnEventsProcessed=!0,e.maybeHandleEcommEvents())}))},getAnalyticsData:function(n){return void 0!==Cookies.get("wffn_ay_"+n)&&""!==Cookies.get("wffn_ay_"+n)?JSON.parse(Cookies.get("wffn_ay_"+n)):[]},HandleAnalytics:function(n,e){var t,i=this,f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"onload",o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",r=4<arguments.length&&void 0!==arguments[4]&&arguments[4];return!(void 0!==window.wffnPublicVars.is_preview&&1===window.wffnPublicVars.is_preview||"onload"===f&&""===window.wffnfunnelData.support_track||void 0===n||void 0===e||!0===this.analyticsAlready(n,e)||(f="undefined"!=typeof wffnEvents?wffnEvents:[],t=""!==o?o:void 0,window.wffnEvents=[],r?this.maybeAddStepCookies(e,n,o):(this.SendData("wffn_frontend_analytics",{events:f,current_step:t},function(){i.maybeAddStepCookies(e,n,o)},n),"undefined"!=typeof wffnEvents&&0!==wffnEvents.length||this.setupWffnEventsListener()),0))},maybeAddStepCookies:function(n,e,t){var i=this.getAnalyticsData(e);""!==t&&void 0!==i&&i.length<1||(i.push(parseInt(n)),Cookies.set("wffn_ay_"+e,JSON.stringify(i),{path:"/"}))},placeNextLink:function(){var n=document.querySelectorAll('a[href*="wffn-next-link=yes"]');0<n.length&&void 0!==window.wffnPublicVars&&""!==window.wffnPublicVars.next_link&&n.forEach(function(e){try{var n=new URL(e.href),t=new URLSearchParams(n.search),i=(t.delete("wffn-next-link"),new URL(window.wffnPublicVars.next_link));t.toString()&&(i.search=t.toString()),e.setAttribute("href",i.toString()),e.classList.add("wffn-next-step-link")}catch(n){e.classList.add("wffn-next-step-link"),e.setAttribute("href",window.wffnPublicVars.next_link)}})},SendData:function(n,e,t){var i,f=3<arguments.length&&void 0!==arguments[3]&&arguments[3];wffnfunnelVars.is_ajax_mode?((i=new XMLHttpRequest).open("POST",window.wffnfunnelVars.ajaxUrl+"?action="+n+(!1!==f?"&wffn-si="+f:""),!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&200===this.status&&t(JSON.parse(this.response))},e="wffn_maybe_setup_funnel"===n?JSON.stringify(e):encodeURIComponent(JSON.stringify(e)),i.send("data="+e)):fetch(window.wffnfunnelVars.restUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:n,data:e})}).then(function(n){return n.json()}).then(t)}};window.wffnPublicVars=window.wffnfunnelData,wffnFunnel.setUpFunnel(),(o=>{wffnFunnel.placeNextLink(),o(document).on("click",'a[href*="wffn-next-link=yes"]',function(n){if(n.preventDefault(),void 0!==window.wffnPublicVars.is_preview&&1===window.wffnPublicVars.is_preview)n.stopPropagation();else if(""!==window.wffnPublicVars.next_link)try{var e=o(this).attr("href"),t=e.startsWith("http")?new URL(e):new URL(e,window.location.origin),i=new URLSearchParams(t.search),f=(i.delete("wffn-next-link"),new URL(window.wffnPublicVars.next_link));f.search=i.toString(),window.location.href=f.toString()}catch(n){window.location.href=window.wffnPublicVars.next_link}}),o(document.body).on("updated_checkout",function(){void 0===window.wffnPublicVars.current_step.id||void 0===window.wffnPublicVars.hash||wffnFunnel.isSetUpCached()||wffnFunnel.HandleAnalytics(window.wffnPublicVars.hash,window.wffnPublicVars.current_step.id,"manual")})})(jQuery);