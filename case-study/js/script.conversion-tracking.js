(()=>{var E=Object.defineProperty,U=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var q=(i,e,o)=>e in i?E(i,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[e]=o,y=(i,e)=>{for(var o in e||(e={}))R.call(e,o)&&q(i,o,e[o]);if(D)for(var o of D(e))N.call(e,o)&&q(i,o,e[o]);return i},k=(i,e)=>U(i,L(e));var B=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var g=(i,e,o)=>new Promise((A,p)=>{var w=s=>{try{l(o.next(s))}catch(c){p(c)}},u=s=>{try{l(o.throw(s))}catch(c){p(c)}},l=s=>s.done?A(s.value):Promise.resolve(s.value).then(w,u);l((o=o.apply(i,e)).next())});var $=B(O=>{(function(){var I;let i=document.currentScript,e="dub_id",o="dub_partner_data",A=90*24*60*60*1e3,p=window.location.hostname,w=i.getAttribute("data-api-host")||"https://api.dub.co",u=i.getAttribute("data-publishable-key"),l=(()=>{let r={domain:p==="localhost"?void 0:`.${p.replace(/^www\./,"")}`,path:"/",sameSite:"Lax",expires:new Date(Date.now()+A).toUTCString()},n=i.getAttribute("data-cookie-options");if(!n)return r;let t=JSON.parse(n);return t.expiresInDays&&(t.expires=new Date(Date.now()+t.expiresInDays*24*60*60*1e3).toUTCString(),delete t.expiresInDays),y(y({},r),t)})(),s=(()=>{let r=i.getAttribute("data-short-domain"),n=i.getAttribute("data-domains");if(n)try{let t=JSON.parse(n);return k(y({},t),{refer:t.refer||r})}catch(t){}return{refer:r}})(),c=s.refer,f=i.getAttribute("data-attribution-model")||"last-click",T=(()=>{let r=i.getAttribute("data-query-param"),n=i.getAttribute("data-query-params"),t=["via"];if(r)t=[r,...t];else if(n)try{t=[...JSON.parse(n),...t]}catch(a){console.warn("[dubAnalytics] Failed to parse data-query-params.",a)}return[...new Set(t)]})(),m=(()=>{let r=new URLSearchParams(location.search);for(let n of T)if(r.get(n))return r.get(n);return null})();if(window.DubAnalytics=window.DubAnalytics||{partner:null,discount:null},window.dubAnalytics){let t=function(a,...d){a==="ready"?t.ready(...d):a==="trackClick"?t.trackClick(...d):console.warn("[dubAnalytics] Unknown method:",a)};var j=t;let n=window.dubAnalytics.q||[];t.q=n,t.ready=function(a){a()},t.trackClick=function(...a){S(...a)},window.dubAnalytics=t}let b={get(r){var n;return(n=document.cookie.split(";").map(t=>t.trim().split("=")).find(([t])=>t===r))==null?void 0:n[1]},set(r,n){let t=Object.entries(l).filter(([,a])=>a).map(([a,d])=>`${a}=${d}`).join("; ");document.cookie=`${r}=${n}; ${t}`}},h={queue:((I=window.dubAnalytics)==null?void 0:I.q)||[],flush(r){let n=[];for(;this.queue.length;){let[t,...a]=this.queue.shift();!r||r(t)?this.process({method:t,args:a}):n.push([t,...a])}this.queue=n},process({method:r,args:n}){if(r==="ready"){let t=n[0];t()}else["trackClick"].includes(r)?S(...n):console.warn("[dubAnalytics] Unknown method:",r)}},_=!1;function S({domain:r,key:n}){_||(_=!0,fetch(`${w}/track/click`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:r,key:n,url:window.location.href,referrer:document.referrer})}).then(t=>t.ok&&t.json()).then(t=>{if(t){if(b.set(e,t.clickId),t.partner){let a=k(y({},t),{partner:k(y({},t.partner),{name:encodeURIComponent(t.partner.name),image:t.partner.image?encodeURIComponent(t.partner.image):null})});b.set(o,JSON.stringify(a)),DubAnalytics.partner=t.partner,DubAnalytics.discount=t.discount,h.flush(d=>d==="ready")}return t}}))}function P(){let r=new URLSearchParams(location.search),n=()=>!b.get(e)||f!=="first-click",t=r.get(e);t&&n()&&b.set(e,t),m&&c&&n()&&S({domain:c,key:m}),h.flush(d=>d==="trackClick");let a=b.get(o);if(a)try{let d=JSON.parse(a);DubAnalytics.partner=d.partner,DubAnalytics.discount=d.discount}catch(d){console.error("[dubAnalytics] Failed to parse partner cookie:",d)}}window._dubAnalytics={c:b,qm:h,i:e,h:p,a:w,d:c,v:m,n:s,k:u},P()})();var C=()=>{let{a:i,k:e,c:o,i:A}=window._dubAnalytics||{};if(!i){console.warn("[dubAnalytics] Missing API_HOST");return}if(!e){console.warn("[dubAnalytics] Missing PUBLISHABLE_KEY");return}let p=u=>g(O,null,function*(){let l=o==null?void 0:o.get(A),s=y({clickId:l!=null?l:""},u),c=yield fetch(`${i}/track/lead/client`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s)}),f=yield c.json();return c.ok||console.error("[dubAnalytics] trackLead failed",f.error),f}),w=u=>g(O,null,function*(){let l=o==null?void 0:o.get(A),s=y({clickId:l!=null?l:""},u),c=yield fetch(`${i}/track/sale/client`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s)}),f=yield c.json();return c.ok||console.error("[dubAnalytics] trackSale failed",f.error),f});if(window.dubAnalytics&&(window.dubAnalytics.trackLead=function(...u){p(...u)},window.dubAnalytics.trackSale=function(...u){w(...u)}),window._dubAnalytics&&window._dubAnalytics.qm){let u=window._dubAnalytics.qm,s=(u.queue||[]).filter(([c,...f])=>c==="trackLead"?(p(...f),!1):c==="trackSale"?(w(...f),!1):!0);u.queue=s}};window._dubAnalytics?C():window.addEventListener("load",C)});$();})();
