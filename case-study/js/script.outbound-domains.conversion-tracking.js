(()=>{var T=Object.defineProperty,N=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var L=(o,r,s)=>r in o?T(o,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[r]=s,g=(o,r)=>{for(var s in r||(r={}))B.call(r,s)&&L(o,s,r[s]);if(q)for(var s of q(r))M.call(r,s)&&L(o,s,r[s]);return o},I=(o,r)=>N(o,R(r));var $=(o,r)=>()=>(r||o((r={exports:{}}).exports,r),r.exports);var C=(o,r,s)=>new Promise((m,p)=>{var y=c=>{try{a(s.next(c))}catch(u){p(u)}},l=c=>{try{a(s.throw(c))}catch(u){p(u)}},a=c=>c.done?m(c.value):Promise.resolve(c.value).then(y,l);a((s=s.apply(o,r)).next())});var H=$(E=>{(function(){var O;let o=document.currentScript,r="dub_id",s="dub_partner_data",m=90*24*60*60*1e3,p=window.location.hostname,y=o.getAttribute("data-api-host")||"https://api.dub.co",l=o.getAttribute("data-publishable-key"),a=(()=>{let e={domain:p==="localhost"?void 0:`.${p.replace(/^www\./,"")}`,path:"/",sameSite:"Lax",expires:new Date(Date.now()+m).toUTCString()},n=o.getAttribute("data-cookie-options");if(!n)return e;let t=JSON.parse(n);return t.expiresInDays&&(t.expires=new Date(Date.now()+t.expiresInDays*24*60*60*1e3).toUTCString(),delete t.expiresInDays),g(g({},e),t)})(),c=(()=>{let e=o.getAttribute("data-short-domain"),n=o.getAttribute("data-domains");if(n)try{let t=JSON.parse(n);return I(g({},t),{refer:t.refer||e})}catch(t){}return{refer:e}})(),u=c.refer,d=o.getAttribute("data-attribution-model")||"last-click",A=(()=>{let e=o.getAttribute("data-query-param"),n=o.getAttribute("data-query-params"),t=["via"];if(e)t=[e,...t];else if(n)try{t=[...JSON.parse(n),...t]}catch(i){console.warn("[dubAnalytics] Failed to parse data-query-params.",i)}return[...new Set(t)]})(),b=(()=>{let e=new URLSearchParams(location.search);for(let n of A)if(e.get(n))return e.get(n);return null})();if(window.DubAnalytics=window.DubAnalytics||{partner:null,discount:null},window.dubAnalytics){let t=function(i,...f){i==="ready"?t.ready(...f):i==="trackClick"?t.trackClick(...f):console.warn("[dubAnalytics] Unknown method:",i)};var _=t;let n=window.dubAnalytics.q||[];t.q=n,t.ready=function(i){i()},t.trackClick=function(...i){k(...i)},window.dubAnalytics=t}let w={get(e){var n;return(n=document.cookie.split(";").map(t=>t.trim().split("=")).find(([t])=>t===e))==null?void 0:n[1]},set(e,n){let t=Object.entries(a).filter(([,i])=>i).map(([i,f])=>`${i}=${f}`).join("; ");document.cookie=`${e}=${n}; ${t}`}},h={queue:((O=window.dubAnalytics)==null?void 0:O.q)||[],flush(e){let n=[];for(;this.queue.length;){let[t,...i]=this.queue.shift();!e||e(t)?this.process({method:t,args:i}):n.push([t,...i])}this.queue=n},process({method:e,args:n}){if(e==="ready"){let t=n[0];t()}else["trackClick"].includes(e)?k(...n):console.warn("[dubAnalytics] Unknown method:",e)}},S=!1;function k({domain:e,key:n}){S||(S=!0,fetch(`${y}/track/click`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:e,key:n,url:window.location.href,referrer:document.referrer})}).then(t=>t.ok&&t.json()).then(t=>{if(t){if(w.set(r,t.clickId),t.partner){let i=I(g({},t),{partner:I(g({},t.partner),{name:encodeURIComponent(t.partner.name),image:t.partner.image?encodeURIComponent(t.partner.image):null})});w.set(s,JSON.stringify(i)),DubAnalytics.partner=t.partner,DubAnalytics.discount=t.discount,h.flush(f=>f==="ready")}return t}}))}function D(){let e=new URLSearchParams(location.search),n=()=>!w.get(r)||d!=="first-click",t=e.get(r);t&&n()&&w.set(r,t),b&&u&&n()&&k({domain:u,key:b}),h.flush(f=>f==="trackClick");let i=w.get(s);if(i)try{let f=JSON.parse(i);DubAnalytics.partner=f.partner,DubAnalytics.discount=f.discount}catch(f){console.error("[dubAnalytics] Failed to parse partner cookie:",f)}}window._dubAnalytics={c:w,qm:h,i:r,h:p,a:y,d:u,v:b,n:c,k:l},D()})();var U=()=>{let{c:o,i:r,h:s,n:m}=window._dubAnalytics,p=new Set;function y(d){return d.replace(/^www\./,"").trim()}function l(d,A){try{let b=new URL(d).hostname,w=y(b),h=y(A);if(h.startsWith("*.")){let S=h.slice(2);return w.endsWith(`.${S}`)}return w===h}catch(b){return!1}}function a(d){var O;let A=Array.isArray(m.outbound)?m.outbound:(O=m.outbound)==null?void 0:O.split(",").map(e=>e.trim());if(!(A!=null&&A.length))return;let b=y(s),w=A.map(y).filter(e=>e!==b),h=d||o.get(r);if(!h)return;let S=document.querySelectorAll("a[href], iframe[src]"),k=document.querySelectorAll("iframe[srcdoc]"),D=[];k.forEach(e=>{try{let n=e.contentDocument;if(n){let t=n.querySelectorAll("iframe[src]"),i=n.querySelectorAll("a[href]");D.push(...t,...i)}}catch(n){console.warn("Could not access contentDocument of srcdoc iframe:",n)}});let _=[...S,...D];!_||_.length===0||_.forEach(e=>{if(!p.has(e))try{let n=e.href||e.src;if(!n||!w.some(f=>l(n,f)))return;let i=new URL(n);i.searchParams.has(r)||(i.searchParams.set(r,h),e.tagName.toLowerCase()==="a"?e.href=i.toString():e.tagName.toLowerCase()==="iframe"&&(e.src=i.toString()),p.add(e))}catch(n){console.error("Error processing element:",n)}})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>a()):a(),setInterval(a,2e3),window.addEventListener("popstate",()=>a());let c=history.pushState,u=history.replaceState;history.pushState=function(){c.apply(this,arguments),a()},history.replaceState=function(){u.apply(this,arguments),a()}};window._dubAnalytics?U():window.addEventListener("load",U);var P=()=>{let{a:o,k:r,c:s,i:m}=window._dubAnalytics||{};if(!o){console.warn("[dubAnalytics] Missing API_HOST");return}if(!r){console.warn("[dubAnalytics] Missing PUBLISHABLE_KEY");return}let p=l=>C(E,null,function*(){let a=s==null?void 0:s.get(m),c=g({clickId:a!=null?a:""},l),u=yield fetch(`${o}/track/lead/client`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(c)}),d=yield u.json();return u.ok||console.error("[dubAnalytics] trackLead failed",d.error),d}),y=l=>C(E,null,function*(){let a=s==null?void 0:s.get(m),c=g({clickId:a!=null?a:""},l),u=yield fetch(`${o}/track/sale/client`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(c)}),d=yield u.json();return u.ok||console.error("[dubAnalytics] trackSale failed",d.error),d});if(window.dubAnalytics&&(window.dubAnalytics.trackLead=function(...l){p(...l)},window.dubAnalytics.trackSale=function(...l){y(...l)}),window._dubAnalytics&&window._dubAnalytics.qm){let l=window._dubAnalytics.qm,c=(l.queue||[]).filter(([u,...d])=>u==="trackLead"?(p(...d),!1):u==="trackSale"?(y(...d),!1):!0);l.queue=c}};window._dubAnalytics?P():window.addEventListener("load",P)});H();})();
